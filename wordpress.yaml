---
  - name: Installs wordpress
    hosts: web
    become: yes
    become_sudo : sudo
    gather_facts: no
    ignore_errors: true 
    connection: ssh
    tasks:
      - name: Install necessary packages
        package:
            name: "{{item}}"
            state: latest
        with_items:
          - wget
          - unzip
          - vim 
          - php-gd
          - httpd
          - mysql
          - mariadb-server
          - php
          - php-mysql
          - php-fpm 
        ignore_errors: true 

      - name: Download wordpress package
        get_url: #package name 
          url: "https://wordpress.org/latest.tar.gz"
          dest: /tmp/ #destination where to store

      - name: Unzip Wordpress file
        unarchive: #module name
          src: "/tmp/latest.tar.gz" #source to what to unzip 
          dest: /var/www/html/wordpress #where to store
        become: yes
        become_method: sudo #to intall all packages and so on

      - name: Move files to html folder
        shell: "mv /var/www/html/wordpress/* /var/www/html"
        become: yes
        become_method: sudo #need privileges 
        ignore_errors: yes #in case if we got errors

      - name: restart httpd
        systemd: #package name 'systemctl'
          name: httpd
          state: restarted #started stop 
          enabled: yes 
        become: yes
        become_method: sudo 
